#!/bin/bash
tty > /dev/null
if [[ $? -eq 0 ]] ; then
	OUTPUT=$(curl -H 'Authorization: 12345678af' "http://192.168.15.10/?c=$1" -XGET -s)
	if [[ $? -ne 0 ]] ; then
		echo "error getting from remote"
		exit 1
	fi
	if ! [[ -z $DISPLAY ]] ; then
		xclip -selection c <<<$OUTPUT
	fi
	echo -n $OUTPUT
else
    curl -H 'Authorization: 12345678af' -H 'Content-Type: text' "http://192.168.15.10/?c=$1" -XPOST -d @- -s <&0
	if [[ $? -ne 0 ]] ; then
	      echo "error saving to remote"
	      exit 1
	fi
fi
